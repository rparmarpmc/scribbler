class PasswordRecoveryButton extends HTMLElement{constructor(){super(),this.addEventListener("click",e=>{e.preventDefault();e=[];let s=document.getElementsByClassName("recovery-spinner");s[0].classList.remove("hidden"),document.getElementById("errors").innerHTML="";var t=document.querySelector("input[name='email']").value;t||e.push("Email cannot be empty"),this.validateEmail(t)||e.push("Email format is incorrect"),0<e.length?(s[0].classList.add("hidden"),document.getElementById("success").innerHTML="",this.handleErrorMessage(e)):((e=fetchConfig("javascript")).headers["X-Requested-With"]="XMLHttpRequest",e.body=JSON.stringify({email:t}),fetch("/apps/scribblerApi/v1/shoppify/private/password_reset",e).then(e=>{if(e.ok)return e.json();throw new Error("HTTP status "+e.status)}).then(e=>{e.success?(s[0].classList.add("hidden"),document.getElementById("errors").innerHTML="",this.handleSuccessMessage(["Email sent"])):(s[0].classList.add("hidden"),document.getElementById("success").innerHTML="",this.handleErrorMessage(e.error_msg))}).catch(e=>{s[0].classList.add("hidden"),document.getElementById("success").innerHTML="",this.handleErrorMessage([e.message])}).finally(()=>{}))})}validateEmail=e=>!!/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e);handleSuccessMessage=()=>{var e=document.getElementById("success"),s=document.createElement("ul"),t=document.createElement("li");t.innerHTML='<svg aria-hidden="true" focusable="false" role="presentation"><use href="#icon-success" /></svg>Email sent',s.appendChild(t),e.appendChild(s)};handleErrorMessage=e=>{var s=document.getElementById("errors");let t=document.createElement("ul");e.map(e=>{var s=document.createElement("li");s.innerHTML='<svg aria-hidden="true" focusable="false" role="presentation"><use href="#icon-error" /></svg>'+e,t.appendChild(s)}),s.appendChild(t)}}customElements.define("password-recovery-button",PasswordRecoveryButton);