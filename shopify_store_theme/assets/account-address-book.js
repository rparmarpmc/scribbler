let type="Direct",addressesList=[],filter=null;fetch("/apps/scribblerApi/v1/shoppify/private/addresses",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(e=>{if(e.ok)return e.json();throw new Error("HTTP status "+e.status)}).then(e=>{0<e.length?(addressesList=e,document.getElementById("customer-account-error").innerHTML="",displayResults()):document.getElementById("customer-account-error").innerHTML="You don't have saved addresses"}).catch(e=>{document.getElementById("customer-account-error").innerHTML=e.message}).finally(()=>{});const showAddresses=(e,s)=>{if(type=s,filter=null,"Indirect"===type?(document.getElementsByClassName("address-list-notice")[0].innerHTML="BTM or Back To Me are your addresses... Products ordered with BTM address are shipped with an extra envelope",document.getElementsByClassName("address-book-sidebar-title")[0].innerHTML="Add a BTM address"):(document.getElementsByClassName("address-list-notice")[0].innerHTML="Direct addresses are sent without an extra envelope to the recipient.",document.getElementsByClassName("address-book-sidebar-title")[0].innerHTML="Add a Direct address"),document.querySelectorAll(".add-address-book-button")[0].innerHTML="Add Address",document.forms["add-new-address-form"]["address[id]"].value=0,document.forms["add-new-address-form"]["address[firstName]"].value="",document.forms["add-new-address-form"]["address[lastName]"].value="",document.forms["add-new-address-form"]["address[firstLine]"].value="",document.forms["add-new-address-form"]["address[secondLine]"].value="",document.forms["add-new-address-form"]["address[townCity]"].value="",document.forms["add-new-address-form"]["address[countyState]"].value="",document.forms["add-new-address-form"]["address[country]"].value="United Kingdom",document.forms["add-new-address-form"]["address[zip]"].value="",document.forms["add-new-address-form"]["address[phone]"].value="",document.forms["add-new-address-form"]["address[defaultAddress]"].checked=!1,e.target.classList.contains("address-book-type-link")){var d=document.getElementsByClassName("address-book-type-link");for(i=0;i<d.length;i++)d[i].className=d[i].className.replace(" address-type-active","");e.currentTarget.className+=" address-type-active"}var r=document.getElementsByClassName("address-filter");for(i=0;i<r.length;i++)r[i].className=r[i].className.replace(" address-filter-selected","");displayResults()},displayResults=()=>{var e=document.getElementById("address-book-container-grid");let d=e.innerHTML="";addressesList.map((e,s)=>{"Indirect"===type&&type===e.type?null!==filter&&e.first_name.toLowerCase().charAt(0)!==filter||(d+=`<div class="address-book-item-grid">
                                <div>
                                    <p class="address-book-name">${e.first_name} ${e.last_name}</p>
                                    ${e.address1?'<p class="address-book-address">'+e.address1+"</p>":""}
                                    ${e.address2?'<p class="address-book-address">'+e.address2+"</p>":""}
                                    ${e.city?'<p class="address-book-address">'+e.city+"</p>":""}
                                    ${e.postcode?'<p class="address-book-address">'+e.postcode+"</p>":""}
                                </div>
                                <div class="address-book-item-grid-right">
                                    ${e.default_address?'<span class="address-book-default-address">Default Address</span>':""}
                                    ${e.default_address?"":'<button class="address-book-set-as-default" onClick="setDefault('+s+')" >Set as Default</button>'}
                                    <div class="address-book-function">
                                        <button class="address-book-function-edit" onClick="editAddresses(${s})">Edit</button>
                                        <button class="address-book-function-delete" onClick="deleteAddresses(${e.id})">Delete</button>
                                    </div>
                                </div>
                            </div>`):"Direct"!==type||type!==e.type||null!==filter&&e.first_name.toLowerCase().charAt(0)!==filter||(d+=`<div class="address-book-item-grid">
                                <div>
                                    <p class="address-book-name">${e.first_name} ${e.last_name}</p>
                                    ${e.address1?'<p class="address-book-address">'+e.address1+"</p>":""}
                                    ${e.address2?'<p class="address-book-address">'+e.address2+"</p>":""}
                                    ${e.city?'<p class="address-book-address">'+e.city+"</p>":""}
                                    ${e.postcode?'<p class="address-book-address">'+e.postcode+"</p>":""}
                                </div>
                                <div class="address-book-item-grid-right">
                                    <span>&nbsp;</span>
                                    <div class="address-book-function">
                                        <button class="address-book-function-edit" onClick="editAddresses(${s})">Edit</button>
                                        <button class="address-book-function-delete" onClick="deleteAddresses(${e.id})">Delete</button>
                                    </div>
                                </div>
                            </div>`)}),e.innerHTML=d},filterAddresses=(e,s)=>{filter=s;var d=document.getElementsByClassName("address-filter");for(i=0;i<d.length;i++)d[i].className=d[i].className.replace(" address-filter-selected","");e.currentTarget.className+=" address-filter-selected",displayResults()},setDefault=e=>{apiUpdateAddress(addressesList[e].id,addressesList[e].first_name,addressesList[e].last_name,addressesList[e].address1,addressesList[e].address2,addressesList[e].city,addressesList[e].county,addressesList[e].country_name,addressesList[e].postcode,addressesList[e].phone,addressesList[e].type,!0)},editAddresses=e=>{document.getElementsByName("address[firstName]")[0].value=addressesList[e].first_name,document.getElementsByName("address[lastName]")[0].value=addressesList[e].last_name,document.getElementsByName("address[firstLine]")[0].value=addressesList[e].address1,document.getElementsByName("address[secondLine]")[0].value=addressesList[e].address2,document.getElementsByName("address[townCity]")[0].value=addressesList[e].city,document.getElementsByName("address[countyState]")[0].value=addressesList[e].county,document.getElementsByName("address[country]")[0].value=addressesList[e].country_name,document.getElementsByName("address[zip]")[0].value=addressesList[e].postcode,document.getElementsByName("address[phone]")[0].value=addressesList[e].phone,document.getElementsByName("address[id]")[0].value=addressesList[e].id,document.getElementsByName("address[defaultAddress]")[0].checked=addressesList[e].default_address,document.querySelectorAll(".add-address-book-button")[0].innerHTML="Update Address",document.querySelectorAll(".address-book-sidebar-title")[0].innerHTML="Update Address"},deleteAddresses=e=>{1!=!confirm("Press OK to confirm address removal or Cancel.")&&fetch("/apps/scribblerApi/v1/shoppify/private/addresses/"+e,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(e=>{if(e.ok)return e.json();throw new Error("HTTP status "+e.status)}).then(e=>{0<e.length?(addressesList=e,document.getElementById("customer-account-error").innerHTML="",document.getElementById("customer-account-success").innerHTML="Address Deleted",displayResults()):(document.getElementById("address-book-container-grid").innerHTML="",document.getElementById("customer-account-error").innerHTML="You don't have saved addresses",document.getElementById("customer-account-success").innerHTML="")}).catch(e=>{document.getElementById("customer-account-error").innerHTML=e.message,document.getElementById("customer-account-success").innerHTML=""}).finally(()=>{})},addAddress=e=>{e.preventDefault();var e=document.forms["add-new-address-form"]["address[id]"].value,s=document.forms["add-new-address-form"]["address[firstName]"].value,d=document.forms["add-new-address-form"]["address[lastName]"].value,r=document.forms["add-new-address-form"]["address[firstLine]"].value,t=document.forms["add-new-address-form"]["address[secondLine]"].value,a=document.forms["add-new-address-form"]["address[townCity]"].value,n=document.forms["add-new-address-form"]["address[countyState]"].value,o=document.forms["add-new-address-form"]["address[country]"].value,c=document.forms["add-new-address-form"]["address[zip]"].value,m=document.forms["add-new-address-form"]["address[phone]"].value,i=document.forms["add-new-address-form"]["address[defaultAddress]"].checked;validateAddressForm(s,d,r,a,n,c,m)&&(0<parseInt(e)?apiUpdateAddress(e,s,d,r,t,a,n,o,c,m,type,i):apiAddAddress(s,d,r,t,a,n,o,c,m,type,i))},validateAddressForm=(e,s,d,r,t,a,n)=>{let o=!0;return e?document.querySelector(".first-name-error").innerHTML="":(o=!1,document.querySelector(".first-name-error").innerHTML="*First Name is required."),s?document.querySelector(".last-name-error").innerHTML="":(o=!1,document.querySelector(".last-name-error").innerHTML="*Last Name is required."),d?document.querySelector(".first-line-error").innerHTML="":(o=!1,document.querySelector(".first-line-error").innerHTML="*Address line 1 is required."),r?document.querySelector(".city-error").innerHTML="":(o=!1,document.querySelector(".city-error").innerHTML="*City is required."),a?document.querySelector(".postcode-error").innerHTML="":(o=!1,document.querySelector(".postcode-error").innerHTML="*Postcode is required."),o},apiUpdateAddress=(e,s,d,r,t,a,n,o,c,m,i,u)=>{fetch("/apps/scribblerApi/v1/shoppify/private/addresses/"+e,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:e,first_name:s,last_name:d,address1:r,address2:t,city:a,county:n,zip:c,phone:m,country_name:o,type:"Direct"===i?"Direct":"Indirect",default_address:u})}).then(e=>{if(e.ok)return e.json();throw new Error("HTTP status "+e.status)}).then(e=>{0<e.length?(addressesList=e,document.forms["add-new-address-form"]["address[id]"].value="",document.forms["add-new-address-form"]["address[firstName]"].value="",document.forms["add-new-address-form"]["address[lastName]"].value="",document.forms["add-new-address-form"]["address[firstLine]"].value="",document.forms["add-new-address-form"]["address[secondLine]"].value="",document.forms["add-new-address-form"]["address[townCity]"].value="",document.forms["add-new-address-form"]["address[countyState]"].value="",document.forms["add-new-address-form"]["address[country]"].value="United Kingdom",document.forms["add-new-address-form"]["address[zip]"].value="",document.forms["add-new-address-form"]["address[phone]"].value="",document.forms["add-new-address-form"]["address[defaultAddress]"].checked=!1,document.getElementById("customer-account-error").innerHTML="",document.getElementById("customer-account-success").innerHTML="Address Updated",document.querySelectorAll(".add-address-book-button")[0].innerHTML="Add Address",displayResults()):(document.getElementById("customer-account-error").innerHTML="You don't have saved addresses",document.getElementById("customer-account-success").innerHTML="")}).catch(e=>{document.getElementById("customer-account-error").innerHTML=e.message,document.getElementById("").innerHTML=""}).finally(()=>{})},apiAddAddress=(e,s,d,r,t,a,n,o,c,m,i)=>{fetch("/apps/scribblerApi/v1/shoppify/private/addresses",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({first_name:e,last_name:s,address1:d,address2:r,city:t,county:a,zip:o,phone:c,country_name:n,type:"Direct"===m?"Direct":"Indirect",default_address:i})}).then(e=>{if(e.ok)return e.json();throw new Error("HTTP status "+e.status)}).then(e=>{0<e.length?(addressesList=e,document.forms["add-new-address-form"]["address[firstName]"].value="",document.forms["add-new-address-form"]["address[lastName]"].value="",document.forms["add-new-address-form"]["address[firstLine]"].value="",document.forms["add-new-address-form"]["address[secondLine]"].value="",document.forms["add-new-address-form"]["address[townCity]"].value="",document.forms["add-new-address-form"]["address[countyState]"].value="",document.forms["add-new-address-form"]["address[country]"].value="United Kingdom",document.forms["add-new-address-form"]["address[zip]"].value="",document.forms["add-new-address-form"]["address[phone]"].value="",document.forms["add-new-address-form"]["address[defaultAddress]"].checked=!1,document.getElementById("customer-account-error").innerHTML="",document.getElementById("customer-account-success").innerHTML="Address Added",displayResults()):(document.getElementById("customer-account-error").innerHTML="You don't have saved addresses",document.getElementById("customer-account-success").innerHTML="")}).catch(e=>{document.getElementById("customer-account-error").innerHTML=e.message,document.getElementById("customer-account-success").innerHTML=""}).finally(()=>{})};