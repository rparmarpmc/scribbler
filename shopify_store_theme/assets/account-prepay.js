const convertFormatCurrency=e=>Intl.NumberFormat(window.Shopify.currency.countryCode,{style:"currency",currency:window.Shopify.currency.active}).format(e*window.Shopify.currency.rate/100),data=(fetch("/apps/scribblerApi/v1/shoppify/private/user/detail",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.prepay_credit_balance&&(document.getElementById("prepay-balance").innerHTML=convertFormatCurrency(e.prepay_credit_balance))}).catch(e=>{console.error(e)}),{collection_id:"PrePay",limit:22,rude:!0,sort_order:"best-selling"}),generatePrepayProducts=(fetch("/apps/scribblerApi/v1/shoppify/public/products/filter",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{0<e.products.length&&generatePrepayProducts(e.products)}).catch(e=>{console.error(e)}),e=>{var t=document.getElementById("prepay-products");let a="";e.map(e=>{a+=`
            <div class="prepay-product">
                <div class="prepay-product-image-wrapper">
                    <img class="prepay-product-image" src="${e?.image?.src}" alt="${e.title}" />
                    <div class="prepay-product-badge">${e.body_html}</div>
                </div>
                <button type="button" aria-label="Add to Basket" name="Add to Basket" onclick="addPrePayToBasket(this,${e?.variants[0]?.id})" class="prepay-add-to-basket">
                   Buy Â£${e?.variants[0]?.price} <div class="prepay-product-add-loader"></div>
                </button>
            </div>`}),t.innerHTML=a}),addPrePayToBasket=(e,t)=>{e.getElementsByTagName("div")[0].style.display="inline-block";var a=fetchConfig("javascript"),r=(a.headers["X-Requested-With"]="XMLHttpRequest",delete a.headers["Content-Type"],new FormData);r.append("id",t),r.append("sections",["cart-icon-bubble"]),r.append("sections_url",window.location.pathname),a.body=r,fetch("/cart/clear.js",{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{fetch(""+routes.cart_add_url,a).then(e=>e.json()).then(e=>{e.status?(document.getElementById("customer-account-error").innerHTML=e.message,document.getElementById("customer-account-success").innerHTML=""):e.sections["cart-icon-bubble"]&&(window.eventBus.publish("UPDATE_CART_KEY",{}),document.getElementById("cart-icon-bubble").innerHTML=e.sections["cart-icon-bubble"].replace('class="shopify-section"',""),window.location="/checkout")}).catch(e=>{console.error(e)}).finally(()=>{e.getElementsByTagName("div")[0].style.display="none"})}).catch(e=>{console.error(e)})};