class LoginUserButton extends HTMLElement{constructor(){super(),this.addEventListener("click",e=>{e.preventDefault();var e=[],t=(document.getElementById("errors").innerHTML="",document.querySelector("input[name='customer[email]']").value),n=document.querySelector("input[name='customer[password]']").value;const s=document.getElementsByClassName("login-spinner");s[0].classList.remove("hidden"),t||e.push("Email cannot be empty"),this.validateEmail(t)||e.push("Email format is incorrect"),n||e.push("Password cannot be empty"),n&&n.length<8&&e.push("Password minimum length is 8 characters"),0<e.length?(s[0].classList.add("hidden"),this.handleErrorMessage(e)):((e=fetchConfig("javascript")).headers["X-Requested-With"]="XMLHttpRequest",e.body=JSON.stringify({email:t,password:n,local:!!window.location.origin.includes("127.0.0.1"),local_domain:window.location.origin,page:"account"}),fetch("/apps/scribblerApi/v1/shoppify/private/login",e).then(e=>{if(e.ok)return e.json();throw new Error("HTTP status "+e.status)}).then(e=>{e.success?(s[0].classList.add("hidden"),document.getElementById("errors").innerHTML="",window.location.origin.includes("127.0.0.1")?window.location=e.data.token_url.replace("https:","http:"):e.data.token_url?window.location=e.data.token_url:this.handleErrorMessage(["Multipass token not available"])):(s[0].classList.add("hidden"),this.handleErrorMessage(e.error_msg))}).catch(e=>{s[0].classList.add("hidden"),this.handleErrorMessage([e.message])}).finally(()=>{}))})}validateEmail=e=>!!/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e);handleErrorMessage=e=>{var t=document.getElementById("errors");const n=document.createElement("ul");e.map(e=>{var t=document.createElement("li");t.innerHTML='<svg aria-hidden="true" focusable="false" role="presentation"><use href="#icon-error" /></svg>'+e,n.appendChild(t)}),t.appendChild(n)}}customElements.define("login-user-button",LoginUserButton);