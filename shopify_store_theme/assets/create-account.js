class CreateAccountButton extends HTMLElement{constructor(){super(),this.addEventListener("click",e=>{e.preventDefault();e=[];const t=document.getElementsByClassName("register-spinner");t[0].classList.remove("hidden"),document.getElementById("register-errors").innerHTML="";var r=document.querySelector("input[name='customer[first_name]']").value,a=document.querySelector("input[name='customer[last_name]']").value,s=document.querySelector("input[name='register-customer[email]']").value,n=document.querySelector("input[name='register-customer[password]']").value,o=document.querySelector("input[name='customer[privacy]']").checked,i=document.querySelector("input[name='customer[terms]']").checked,c=document.querySelector("input[name='customer[marketing]']").checked;r||e.push("First name cannot be empty"),a||e.push("Last name cannot be empty"),s||e.push("Email cannot be empty"),this.validateEmail(s)||e.push("Email format is incorrect"),n||e.push("Password cannot be empty"),n&&n.length<8&&e.push("Password minimum length is 8 characters"),o||e.push("You must read and agree to our Privacy Policy"),i||e.push("You must read and agree to our Terms and Condition"),0<e.length?(t[0].classList.add("hidden"),this.handleErrorMessage(e)):((e=fetchConfig("javascript")).headers["X-Requested-With"]="XMLHttpRequest",e.body=JSON.stringify({firstName:r,lastName:a,email:s,password:n,privacy:o,terms:i,marketing:c}),fetch("/apps/scribblerApi/v1/shoppify/private/register",e).then(e=>{if(e.ok)return e.json();throw new Error("HTTP status "+e.status)}).then(e=>{e.success?(t[0].classList.add("hidden"),document.getElementById("register-errors").innerHTML="",e.data.token_url?window.location=e.data.token_url:this.handleErrorMessage(["Multipass token not available"])):(t[0].classList.add("hidden"),this.handleErrorMessage(e.error_msg))}).catch(e=>{t[0].classList.add("hidden"),this.handleErrorMessage([e.message])}).finally(()=>{}))})}validateEmail=e=>!!/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e);handleErrorMessage=e=>{var t=document.getElementById("register-errors");const r=document.createElement("ul");e.map(e=>{var t=document.createElement("li");t.innerHTML='<svg aria-hidden="true" focusable="false" role="presentation"><use href="#icon-error" /></svg>'+e,r.appendChild(t)}),t.appendChild(r)}}customElements.define("create-account-button",CreateAccountButton);