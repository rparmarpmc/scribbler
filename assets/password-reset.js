class PasswordResetButton extends HTMLElement{constructor(){super(),this.addEventListener("click",e=>{e.preventDefault();e=[];let s=document.getElementsByClassName("reset-spinner");s[0].classList.remove("hidden"),document.getElementById("errors").innerHTML="";var t=document.querySelector("input[name='new-password']").value,r=document.querySelector("input[name='new-password-confirm']").value,n=window.location,n=new URLSearchParams(n.search).get("token");42!==n.length&&e.push("Token length is incorrect"),t!==r&&e.push("Passwords are different"),t||e.push("Password cannot be empty"),t&&t.length<8&&e.push("Password minimum length is 8 characters"),0<e.length?(s[0].classList.add("hidden"),this.handleErrorMessage(e)):((r=fetchConfig("javascript")).headers["X-Requested-With"]="XMLHttpRequest",r.body=JSON.stringify({token:n,password:t}),fetch("/apps/scribblerApi/v1/shoppify/private/new_password",r).then(e=>{if(e.ok)return e.json();throw new Error("HTTP status "+e.status)}).then(e=>{e.success?(s[0].classList.add("hidden"),window.location="/account/login"):(s[0].classList.add("hidden"),this.handleErrorMessage(e.error_msg))}).catch(e=>{s[0].classList.add("hidden"),this.handleErrorMessage([e.message])}).finally(()=>{}))})}handleErrorMessage=e=>{var s=document.getElementById("errors");let t=document.createElement("ul");e.map(e=>{var s=document.createElement("li");s.innerHTML='<svg aria-hidden="true" focusable="false" role="presentation"><use href="#icon-error" /></svg>'+e,t.appendChild(s)}),s.appendChild(t)}}customElements.define("password-reset-button",PasswordResetButton);